#' Plots samples within a 3D model
#' 
#' Given a vector of named sample coordinates and colors, first determines if any samples are missing color info, then plots samples in an existing 3D model
#' @import misc3d
#' @import rgl
#' @param sampleCoordinates Coordinates of samples with columns x y and z, each row is a sample with a row name
#' @param colors vector of colors, usually corresponding to intensity of metric of interest; should be length of number of samples and also have names
#' @export 

plot3DSamples <- function(sampleCoordinates, colors){
  samplesToPlot <- rownames(sampleCoordinates)[rownames(sampleCoordinates) %in% names(colors)]
  sampleCoordinates <- sampleCoordinates[samplesToPlot,]
  sampleColors <- colors[samplesToPlot]
  points3d(x=sampleCoordinates[,1], y=sampleCoordinates[,2], z=sampleCoordinates[,3], level = 1, size = 7, color=sampleColors)
  text3d(x=sampleCoordinates[,1], y=sampleCoordinates[,2], z=sampleCoordinates[,3], texts = rownames(sampleCoordinates), cex=1, adj=-.3)
}